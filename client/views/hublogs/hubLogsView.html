
<template name="hubLogsView">
    {{#if isEnvironmentsLoaded}}
    <div id="SeachHubLogsForm">
        <div class="container">
            <div class="row">
                <div class="col-md-12, col-lg-12"><h2>Environments</h2></div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-3">
                    <select id="environmentsDropDown" class="form-control">

                        {{#each env in getEnvironments}}
                            {{> option environmentOptions env}}
                        {{/each}}

                    </select>
                </div>
            </div>
            <div class="component-spacer"></div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="button-container">
                        <ul class="list-inline">
                            <li><button type="reset" class="btn btn-default btn-sm" id="clearFilter">Clear Filter</button></li>
                            <li><button data-toggle="collapse" data-target="#filters" type="button" class="btn btn-default btn-sm" id="btnSearch">Search</button></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="component-spacer sm"></div>
            <div class="row">
                <div class="col-lg-12">
                    <div id="accordion" class="panel-group">
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                                <a data-toggle="collapse" data-parent="#accordion" href="#filters">
                                    <h3 class="panel-title">
                                        Filters
                                    </h3>
                                </a>
                            </div>

                            <div id="filters" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <h3>Application Filters</h3>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4"><label for="start">Start:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" placeholder="0" name="start" value="{{start}}" class="input-full-width" id="start"><span class="label label-danger">{{responseMsg}}</span></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="rowsPerPage">Rows per Page:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{rowsPerPage}}" name="rowsPerPage" class="input-full-width" id="rowsPerPage"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="requestId">RequestId:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{requestId}}" name="requestId" class="input-full-width" id="requestId"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="serviceId">ServiceId:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{serviceId}}" name="serviceId" class="input-full-width" id="serviceId" maxlength="3"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="sourceName">SourceName:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{sourceName}}" name="sourceName" class="input-full-width" id="sourceName"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="userId">UserId:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{userId}}" name="userId" class="input-full-width" id="userId"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="severity">Severity:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" name="severity" value="{{severity}}" class="input-full-width" id="severity" maxlength="1" placeholder="E, I, C, W"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="earliestDate">EarliestDate:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="datetime" name="earliestDate" value="{{earliestDate}}" placeholder="YYYY-MM-DD hh:mm:ss.sss" class="input-full-width" id="earliestDate"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="latestDate">LatestDate:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="datetime" name="latestDate" value="{{latestDate}}" placeholder="YYYY-MM-DD hh:mm:ss.sss" class="input-full-width" id="latestDate"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="logCode">LogCode:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{logCode}}" name="logCode" class="input-full-width" id="logCode"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="requestMessage">Request Message:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{requestMessage}}" name="requestMessage" class="input-full-width" id="requestMessage"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="logMessage">Log Message:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" value="{{logMessage}}" name="logMessage" class="input-full-width" id="logMessage"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 filter-input"><label for="logMessage">No Records:&nbsp;</label>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="text" name="noRecords" value="{{noRecords}}" class="input-full-width" id="noRecords"></div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 "><div class="checkbox"><label><input type="checkbox" name="errorsOnly" id="errsOnly" {{errsOnly}}>Errors Only</label></div></div>
                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 "><div class="checkbox"><label><input type="checkbox" name="olbPing" id="olbPing" {{olbPing}}>Include OLB Ping</label></div></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <h3>Front End Applications</h3><hr/>
                                        </div>
                                    </div>
                                    {{#if isApplicationsLoaded}}
                                        {{#each applications}}
                                            {{> applicationRow}}
                                        {{/each}}
                                    {{else}}
                                        {{> spinner}}
                                    {{/if}}
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="row">
                <div class="col-lg-6"><a href="" class="prev">{{prev}}</a></div>
                <div class="col-lg-6"><a href="" class="next">{{next}}</a></div>
            </div>

        </div>
    </div>
    {{#if areLogsLoaded}}
    <div class="container-fluid">
    <div class="component-spacer sm">
        <table class="table table-striped table-hover" width="100%">
            <thead>
            <tr>
                <th>RID</th>
                <th>TIME</th>
                <th>PERFORMANCE</th>
                <th>BRAND</th>
                <th>APP</th>
                <th>APP_NAME</th>
                <th>REGION</th>
                <th>USER_ID</th>
                <th>REQ_MESS</th>
                <th>SVC_ID</th>
                <th>SVC_NAME</th>
                <th>SEV</th>
                <th>LOG_CDE</th>
                <th>LOG_TEXT</th>
                <th>SRC_NAME</th>
                <th>PROVIDER</th>
                <th>LOG_MESS</th>
                <th>MESSAGE_ID</th>
                <th>RSID</th>
                <th>SmartComms_REQ_CONTENT</th>
            </tr>
            </thead>
            <tbody>
            {{#each hubLog}}
                <tr>
                    <!--<td><input type="hidden" text="{{RowNum}}"><a href="/ema/hublog/requestId/{{REQUEST_ID}}" class="req">{{REQUEST_ID}}</a></td>-->
                    <td><a href="{{getRequestIdUrl REQUEST_ID}}" class="reqId">{{REQUEST_ID}}</a></td>
                    <td>{{formatDateTime REQUEST_DTE}}</td>
                    <td><a href="{{serviceStatsPath REQUEST_ID}}" id="serviceRequestPerf">Performance</a></td>
                    <td>{{BRAND_NME}}</td>
                    <td><a href="{{getApplicationCodeUrl APPLICATION_CDE}}" class="appCode">{{APPLICATION_CDE}}</a></td>
                    <td>{{APPLICATION_NME}}</td>
                    <td>{{INSTANCE_NME}}</td>
                    <td>{{USERID}}</td>
                    {{#if isEmpty MESSAGE_TXT}}
                        <td>&nbsp;</td>
                    {{else}}
                        <td>
                            <div class="panel-group" id="accordion{{RowNum}}">
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h4 class="panel-title">
                                            <a data-toggle="collapse" data-parent="#accordion{{RowNum}}" href="#collapse{{RowNum}}" class="msg-panel">Request Message</a>
                                        </h4>
                                    </div>
                                    <div id="collapse{{RowNum}}" class="panel-collapse collapse">
                                        <div class="panel-body">
                                            <pre>{{formatText MESSAGE_TXT}}</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    {{/if}}
                    <td><a href="{{getServiceIdUrl SERVICE_ID}}" class="srvcId">{{SERVICE_ID}}</a></td>
                    <td>{{SERVICE_NME}}</td>
                    <td>{{SEVERITY_CDE}}</td>
                    <td>{{LOG_CDE}}</td>
                    <td><div style="word-wrap: break-word;">{{LOG_TXT}}</div></td>
                    <td><a href="{{getSourceNameUrl SOURCE_NME}}" class="srcName">{{SOURCE_NME}}</a></td>
                    <td>{{APPLICATION_NAME}}</td>
                    {{#if isEmpty MESSAGE_TEXT}}
                        <td>&nbsp;</td>
                    {{else}}
                        <td>
                            <div class="panel-group" id="log_mess_accord{{RowNum}}">
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        <h4 class="panel-title">
                                            <a data-toggle="collapse" data-parent="#log_mess_accord{{RowNum}}" href="#collapse_log{{RowNum}}" class="msg-panel">Response Message</a>
                                        </h4>
                                    </div>
                                    <div id="collapse_log{{RowNum}}" class="panel-collapse collapse">
                                        <div class="panel-body">
                                            <pre>{{formatText MESSAGE_TEXT}}</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    {{/if}}
                    <td>{{MESSAGE_ID}}</td>
                    <td>{{REQUEST_SERVICE_ID}}</td>
                    <td>{{THUNDERHEAD_CONTENT}}</td>
                </tr>
            {{/each}}
            </tbody>
        </table>
        <div class="container">
            <div class="row">
                <div class="col-lg-6"><a href="" class="prev">{{prev}}</a></div>
                <div class="col-lg-6"><a href="" class="next">{{next}}</a></div>
            </div>
        </div>
    </div>
    </div>
    {{else}}
        {{> spinner}}
    {{/if}}

    {{else}}
        {{> spinner}}
    {{/if}}

</template>

